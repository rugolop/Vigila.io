name: ðŸ§ª Test SSH Connection

on:
  workflow_dispatch:  # Solo ejecuciÃ³n manual

jobs:
  test-ssh:
    name: ðŸ”Œ Test SSH Connection
    runs-on: ubuntu-latest
    
    steps:
      - name: ðŸ“‹ Show connection info (masked)
        run: |
          echo "Testing SSH connection to Dokploy server..."
          echo "Host: ${{ secrets.DOKPLOY_HOST }}"
          echo "User: ${{ secrets.DOKPLOY_USER }}"
          echo "Port: 22"
      
      - name: ðŸ”‘ Test SSH Connection
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.DOKPLOY_HOST }}
          username: ${{ secrets.DOKPLOY_USER }}
          key: ${{ secrets.DOKPLOY_SSH_KEY }}
          port: 22
          script: |
            echo "âœ… SSH Connection successful!"
            echo "Hostname: $(hostname)"
            echo "User: $(whoami)"
            echo "Docker version: $(docker --version)"
            echo ""
            echo "ðŸ“‹ Docker services:"
            docker service ls
            echo ""
            echo "ðŸŽ¯ Vigila services:"
            docker service ls | grep vigila || echo "No vigila services found"
